Condition
Will only attempt to run if the message includes the string CPLogToSyslog
Configuration
grok_pattern: ^%{DAY:UNWANTED}%{SPACE:UNWANTED}%{MONTH:UNWANTED}%{SPACE:UNWANTED}%{MONTHDAY:UNWANTED}%{SPACE:UNWANTED}(?!<[0-9])%{HOUR:UNWANTED}:%{MINUTE:UNWANTED}(?::%{SECOND:UNWANTED})(?![0-9])%{SPACE:UNWANTED}%{DATA:UNWANTED}%{SPACE:UNWANTED}CPLogToSyslog:%{SPACE:UNWANTED}ContentVersion: 5; Uuid: %{DATA:UNWANTED}; SequenceNum: %{DATA:UNWANTED}; Flags: %{DATA:UNWANTED}; Action: %{DATA:CKP_Action}; Origin: %{DATA:UNWANTED}; IfDir: %{DATA:UNWANTED}; InterfaceName: %{DATA:CKP_InterfaceName}; Alert: %{DATA:UNWANTED}; LogId: %{DATA:UNWANTED}; OriginSicName: %{DATA:UNWANTED}; OriginSicName: %{DATA:UNWANTED}; log_type: %{DATA:UNWANTED}; is_first_for_luuid: %{DATA:UNWANTED}; ?(ICMP: %{DATA:UNWANTED}; )??(TCP packet out of state: %{DATA:UNWANTED}; )??(tcp_flags: %{DATA:CKP_tcp_flags}; )??(inzone: %{DATA:UNWANTED}; )??(outzone: %{DATA:UNWANTED}; )??(service_id: %{DATA:CKP_service_id}; )?src: %{DATA:CKP_src}; dst: %{DATA:CKP_dst}; proto: %{DATA:UNWANTED}; ?(ICMP Type: %{DATA:UNWANTED}; )??(ICMP Code: %{DATA:UNWANTED}; )??(message_info: %{DATA:UNWANTED}; )??(xlatesrc: %{DATA:CKP_xlatesrc}; )??(NAT_rulenum: %{DATA:CKP_NAT_rulenum}; )??(NAT_addtnl_rulenum: %{DATA:UNWANTED}; )??(match_id: %{DATA:CKP_match_id}; )??(match_table.match_id: %{DATA:UNWANTED}; )??(layer_uuid: %{DATA:UNWANTED}; )??(match_table.layer_uuid: %{DATA:UNWANTED}; )??(layer_name: %{DATA:UNWANTED}; )??(match_table.layer_name: %{DATA:CKP_match_table.layer_name}; )??(rule_uid: %{DATA:UNWANTED}; )??(match_table.rule_uid: %{DATA:UNWANTED}; )??(rule_name: %{DATA:CKP_rule_name}; )??(match_table.rule_name: %{DATA:UNWANTED}; )??(rule_action: %{DATA:UNWANTED}; )??(match_table.rule_action: %{DATA:UNWANTED}; )??(parent_rule: %{DATA:UNWANTED}; )??(match_table.parent_rule: %{DATA:UNWANTED}; )?aba_customer: %{DATA:UNWANTED}; date: %{DATA:CKP_date}; hour: %{DATA:CKP_hour}; type: %{DATA:UNWANTED}; Interface: %{DATA:UNWANTED}; ProductName: %{DATA:UNWANTED};?((svc: %{DATA:CKP_svc}; sport_svc: %{DATA:UNWANTED};)(%{SPACE:UNWANTED}xlatedport_svc: ?(%{DATA:UNWANTED});)?(%{SPACE:UNWANTED}xlatesport_svc: %{INT:CKP_xlatesport_svc};)|$)
